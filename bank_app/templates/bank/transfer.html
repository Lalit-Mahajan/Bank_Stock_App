<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>SmartPay Bank - Transfer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">
    {% include 'navbar.html' %}
    <div class="container mt-5 col-md-5">

        <!-- BANK HEADER -->
        <div class="text-center mb-3">
            <h3 class="text-success fw-bold">SmartPay Bank</h3>
        </div>

        <div class="card shadow">
            <div class="card-header bg-success text-white text-center">
                Bravo - Pay Amount
            </div>

            <div class="card-body">

                <!-- ALERTS -->
                {% with messages = get_flashed_messages(with_categories=true) %}
                {% for category, msg in messages %}
                <div class="alert alert-{{category}} alert-dismissible fade show">
                    {{msg}}
                    <button class="btn-close" data-bs-dismiss="alert"></button>
                </div>
                {% endfor %}
                {% endwith %}

                <form method="post">
                    <label>Alpha Account Number</label>
                    <input type="text" id="account_no" class="form-control mb-3" placeholder="Enter Alpha Account No"
                        required>

                    <label>Alpha Name</label>
                    <input type="text" id="alpha_name" class="form-control mb-3" readonly>

                    <input type="hidden" name="alpha_id" id="alpha_id">

                    <label>Enter Amount</label>
                    <input type="number" name="amount" class="form-control mb-4" required>

                    <!-- BUTTON ROW -->
                    <div class="d-flex justify-content-between">
                        <a href="/bank/transfer" class="btn btn-outline-secondary">
                            Pay Again
                        </a>

                        <button class="btn btn-success px-4">
                            Send Money
                        </button>

                        <a href="/bank/bravo" class="btn btn-outline-primary">
                            Go Home
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        document.getElementById("account_no").addEventListener("blur", function () {
            let accNo = this.value;
            if (!accNo) return;

            fetch(`/bank/get-alpha-user?account_no=${accNo}`)
                .then(res => res.json())
                .then(data => {
                    if (data.status === "success") {
                        document.getElementById("alpha_name").value = data.name;
                        document.getElementById("alpha_id").value = data.user_id;
                    } else {
                        alert("Invalid Alpha Account Number");
                        document.getElementById("alpha_name").value = "";
                        document.getElementById("alpha_id").value = "";
                    }
                });
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>